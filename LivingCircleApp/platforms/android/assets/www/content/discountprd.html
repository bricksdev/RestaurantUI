<!DOCTYPE html>
<html>
<head>
<title>折扣发布</title>
<meta charset="utf-8" />
<meta name="format-detection" content="telephone=no" />
<meta name="msapplication-tap-highlight" content="no" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../css/warm-app-theme.min.css" />
<link rel="stylesheet" href="../css/jquery.mobile.icons.min.css" />
<link rel="stylesheet" href="../css/jquery.mobile.structure.min.css">
<link rel="stylesheet" href="../css/jquery.mobile.datepicker.css">
<script src="../js/jquery.min.js"></script>
<script src="../js/jquery.mobile.min.js"></script>
<script src="../js/jquery.ui.datepicker.js"></script>
<script id="mobile-datepicker" src="../js/jquery.mobile.datepicker.js"></script>
<script src="../js/bricksjs.app.core.js"></script>
<script type="text/javascript">
	$(function() {
		$("#file-2").change(function() {
			RestaurantApp.imagePreview($.mobile.browser, this, "image");
		})
	});

	$(function() {
		$('#publish').click(function() {
			$('#infoDiv').html('开始上传中....');
			$('#infoDiv').addClass("display-area");
			// 使用 jQuery 异步提交表单 
			$('#formFile').submit({

				success : function(data) {
					alert(data);
					if (data.success) {
						alert('message ' + data.message);
					} else {
						if ($("#errorDiv")) {
							$("#errorDiv").html(data.error);
							$("#errorDiv").addClass("display-area error-area");
						} else {
							alert('error ' + data.error);
						}
					}
				}
			});

			// 			}); 
			// 			$('#formFile').submit();
		});
	});
</script>
</head>
<body>

	<div data-role="page">
		<header data-role="header" data-position="fixed">
			<a href="javascript:;" onClick="javascript:history.back(-1);"
				data-icon="carat-l" data-iconpos="left" data-transition="none">返回</a>
			<h1>折扣发布</h1>

		</header>
		<div id="errorDiv"></div>
		<div id="infoDiv"></div>
		<div data-role="main">
			<form id='formFile' name='formFile' method="POST"
				action="http://localhost:8099/postdiscount" enctype="multipart/form-data" target="frameFile">
				<ul data-role="listview">
					<li class="ui-field-contain"><input name="name" id="name"
						placeholder="产品名称" type="text"></li>
					<li class="ui-field-contain"><textarea cols="40" rows="8"
							name="details" id="details" placeholder="产品描述"></textarea></li>
					<li class="ui-field-contain"><select name="discount"
						id="discount" data-native-menu="false">
							<option>折扣比率</option>
							<option value="10">1折</option>
							<option value="20">2折</option>
							<option value="30">3折</option>

					</select></li>
					<li class="ui-field-contain"><input name="stoptime"
						id="stoptime" data-role="date" type="date" placeholder="有效期"></li>
					<li class="ui-field-contain" data-icon="none"><img
						src="../img/camera-white.png" alt="添加图片"
						onclick="$('#file-2').click()" />
						<div id="preview">
							<a href="#popupParis" data-rel="popup" data-position-to="window"
								data-transition="fade" style="display: none;" id="imagea0"><img
								class="popphoto" src="" style="width: 30%;" id="imageimg0">
								<span style="display: none;"><input type="file"
									name="imagefile0" id="imagefile0"></span> </a> <a
								href="#popupSydney" data-rel="popup" data-position-to="window"
								data-transition="fade" style="display: none;" id="imagea1"><img
								class="popphoto" src="" id="imageimg1" style="width: 30%;">
								<span style="display: none;"><input type="file"
									name="imagefile1" id="imagefile1"></span> </a> <a
								href="#popupNYC" data-rel="popup" data-position-to="window"
								data-transition="fade" style="display: none;"><img
								class="popphoto" src="../img/camera.png" style="width: 30%;">
								<span style="display: none;"><input type="file"
									name="imagefile2" id="imagefile2"></span> </a>

							<div data-role="popup" id="popupParis" data-corners="false">
								<a href="#" data-rel="back"
									class="ui-btn ui-corner-all ui-shadow ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a><img
									class="popphoto" src="" id="imagepopup0"
									style="max-height: 512px;">
							</div>
							<div data-role="popup" id="popupSydney" data-corners="false">
								<a href="#" data-rel="back"
									class="ui-btn ui-corner-all ui-shadow  ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a><img
									class="popphoto" src="../img/camera.png"
									style="max-height: 512px;">
							</div>
							<div data-role="popup" id="popupNYC" data-corners="false">
								<a href="#" data-rel="back"
									class="ui-btn ui-corner-all ui-shadow  ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a><img
									class="popphoto" src="../img/camera.png"
									style="max-height: 512px;">
							</div>

						</div> <span style="display: none;"><input type="file"
							name="file-2" id="file-2" multiple="multiple" ></span></li>
					<li class="ui-body">
						<fieldset class="ui-grid-a">
							<div class="ui-block-a">
								<button id="cancel" class="ui-btn ui-corner-all ">取消</button>
							</div>
							<div class="ui-block-b">
								<button id="publish" class="ui-btn ui-corner-all ">发布</button>
							</div>
						</fieldset>
					</li>
				</ul>
			</form>
			<iframe id='frameFile' name='frameFile' style='display: none;'></iframe>
		</div>

	</div>


</body>
</html>
